# Инструкция по запуску inference.py

## Проблемы и решения

### Основные проблемы, которые были исправлены:

1. **Отсутствие зависимостей**: Установлен `hydra-core` и другие необходимые пакеты
2. **Отсутствие модуля datasets**: Создан `src/datasets/asv_spoof.py`
3. **Неправильные размеры тензоров**: Исправлена обработка размерностей в `ASVSpoofDataset`
4. **Проблемы с Hydra**: Создана упрощенная версия без Hydra
5. **Неправильные размеры модели**: Исправлены размеры входных данных в LCNN

## Как использовать

### 1. Установка зависимостей
```bash
# Активируйте виртуальное окружение
source venv/bin/activate

# Установите зависимости (если еще не установлены)
pip install -r requirements.txt
pip install hydra-core
```

### 2. Загрузка модели (если у вас есть файл модели)
```bash
# Если у вас есть файл модели в другом месте
python copy_model.py
# Введите путь к вашему файлу модели
```

### 3. Запуск inference

#### Вариант 1: Исправленная версия (рекомендуется)
```bash
python inference_fixed.py
```

#### Вариант 2: Оригинальная версия (может не работать из-за проблем с Hydra)
```bash
python inference.py
```

### 4. Проверка результатов
```bash
# Посмотреть результаты
cat experiments/lcnn_asv_2/predictions.csv
```

## Структура файлов

- `inference_fixed.py` - исправленная версия без Hydra
- `inference_simple.py` - упрощенная версия для тестирования
- `copy_model.py` - скрипт для копирования модели
- `src/datasets/asv_spoof.py` - класс для работы с датасетом
- `src/model/lcnn_model.py` - модель LCNN
- `src/transforms/stft.py` - трансформации для аудио
- `src/metrics/eer.py` - метрики EER

## Конфигурация

Модель настроена на использование весов из `experiments/lcnn_asv_2/best_model.pth`.

Если у вас есть обученная модель в другом месте, используйте `copy_model.py` для копирования.

## Примечания

- Скрипт использует dummy данные, если не найден файл протокола ASVspoof2019
- Для получения реальных результатов нужны данные ASVspoof2019
- Модель работает с необученными весами, если файл модели не найден